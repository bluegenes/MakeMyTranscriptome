The Expression tool is a pipeline that performs a few differential expression analyses on a provided assembly and set of reads. In order to perform this analysis, the tool needs to know some metadata for the reads. Because of this, you must describe your reads using a formatted csv file and pass this file as input to the expression file. For details about using the csv input, consult the [CSV wiki page](CSV_input). To execute the expression tool, call

```
python pipeline.py expression [INPUT] [OPTIONS] [FLAGS]

INPUT - Both of these must be provided
  -a ASSEMBLY, --assembly ASSEMBLY
                        A fasta transcriptome assembly that will be used for 
                        computing expression levels.
  --csv CSV             A CSV file specifying fastq input, basenames for DE,
                        and factors for DE. Consult the CSV wiki page, linked 
                        above for more information about formatting this input 
                        file format.

OPTIONS 
  --model MODEL         An optional list of comma separated values used to run
                        differential expression. This is particularly useful
                        for refining Differential Expression runs as it allow
                        you to use the same input CSV file and perform new
                        comparisons. If left blank, the model is inherited 
                        from the input csv file.
  --cpu CPU             Sets the thread cap for execution. Default is 12. Use
                        0 to indicate no process cap should be used.
  --email EMAIL         Pipeline will send emails informing you of runstate.
  --out_dir OUT_DIR     Path to the ouput location. Defaults to assemblies
                        directory inside pipeline
  -o OUT_NAME, --out_name OUT_NAME
                        The name of the output directory to be made in
                        out_dir. If unused, name will be inherited from input
                        file names

FLAGS
  -no_log               Pipeline will delete log files.
  -force                Use this flag to perform a fresh run of the pipeline.
                        All steps will be executed regradless of what has
                        already been performed.
```
## Output
The output of the expression tool is an assembly directory, identical in basic structure to every other tool. The principle output is located in the root of the assembly directory and called "FILE whose name I don't know yet because it isn't be generated yet." It contains the most significant changes in expression identified by the various differential expression pipelines. What follows is a full description of the assembly directory constructed by running the expression tool. In the following tree, "--" mean that the object is a file while ">>" means the object is a directory.

```
<out_name>
    --<out_name>.fasta
    --file_that_is_yet_to_be_made
    --run.log
    >>annotation_files
    >>assembly_files
    >>expression_files
        --bed_counts.countsTable
        --bed_counts_byGene.countsTable
        --bed_counts_threshold.countsTable
        >>deseq2_express_<model>
        >>deseq2_intersect_<model>
        --express_counts.countsTable
        --express_counts_byGene.countsTable
        --express_counts_threshold.countsTable
        --<fq_reads_name>.bed
        --<fq_reads_name>.xprs
        --<fq_reads_name>_express_bt2.bam
        --<fq_reads_name>_intersect_bt2.bam
        --<fq_reads_name>_intersect_bt2_sorted.bam
        --<out_name>.<K>.bt2
        --<out_name>.bed
        --<out_name>.rev.<K>.bt2
        --sample_info.tsv
    >>logs

```
### Description of output files and directories

**\<out\_name\>** - This directory is the output directory generated by running OCT. It is taken directly from the "--out\_name"  options. If the option is not specified, OCT will construct a name from the input fastq file names. It is strongly recommended that you use the "--out\_name" option.

**\<out\_name\>.fasta** - This file contains the provided assembly that OCT is annotating. It has been copied here so that you can easily keep your assembly with your data. This file inherits its name from the name of the output directory.

**file\_that\_is\_yet\_to\_be\_made** - This file contains the principle output of the expression pipeline. It compiles the most significant changes in expression identified by the various strategies into a single easy to parse file.

**run.log** - This file contains a log of all of the jobs performed by OCT, and when they were performed.

**annotation\_files** - This directory contains all files generated by the annotation pipeline. It is not populated by the expression pipeline. To populate this directory, execute the annotation pipeline.

**assembly\_files** - This directory contains all files generated by the assembly pipeline. It is not populated by the expression pipeline. To populate this directory, execute the assembly pipeline.

**expression\_files** - This directory contains all files generated by the expression pipeline.

**bed\_counts.countsTable** - This file contains a table in which columns are tab seperated and rows are line separated describing, for each contig id feature, the number of reads in each input file that overlaps that feature according to the intersect bed style analysis.

**bed\_counts\_byGene.countsTable** - Same as previous file, but now features are defined over genes instead of contigs.

**bed\_counts\_threshold.countsTable** - Same as 'bed\_counts.countsTable' but low count features (contigs with low transcription level) have been removed.

**deseq2\_express\_\<model\>** A folder containing expression level comparisons for your reads using transcription levels computed by express. 

**deseq2\_intersect\_\<model\>** - A folder containing expression level comparisons for your reads using transcription levels computed by using intersect bed.

**express\_counts.countsTable** - This file contains a table in which columns are tab separated and rows are line separated describing, for each contig id feature, the transcription level of that contig in each of the input files according to the express style pipeline.

**express\_counts\_byGene.countsTable** - same as previous file, but now features are defined over genes instead of contigs.

**express\_counts\_threshold.countsTable** - Same as 'express\_counts.countsTable' but low count features (contigs with low transcription level) have been removed.

**\<fq\_reads\_name\>.bed** - A bed file that describes alignments of each of your reads from the file \<fq\_reads\_name\> to your assembly.

**\<fq\_reads\_name\>.xprs** - An express output file for the reads from file \<fq\_reads\_name\> and your assembly. For me details on the contents of the file, consult the eXpress documentation found [at this link](http://bio.math.berkeley.edu/eXpress/manual.html).

**\<fq\_reads\_name\>\_express\_bt2.bam** - A bam file generated by bowtie 2 that is attempting to align your reads to the provided assembly. This file will be used by express to compute transcriptions levels. For me details on the contents of this file, consult the bowtie 2 documentation found [at this link](http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml).

**\<fq\_reads\_name\>\_intersect\_bt2.bam** -  Same as above file, except this file contains alignments that will be used by intersect to compute transcription levels.

**\<fq\_reads\_name\>\_intersect\_bt2\_sorted.bam** - A version of the previous file sorted by alignment position in the provided assembly.

**\<out\_name\>.\<K\>.bt2** - These files are an index of your provided assembly created by bowtie 2 in order for it to do its mapping. For details on this files, consult the bowtie 2 documentation found [at this link](http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml).

**\<out\_name\>.bed** - A bed file representing the provided assembly.

**\<out\_name\>.rev.\<K\>.bt2** - These files are an index of your provided assembly created by bowtie 2 in order for it to do its mapping. For details on this files, consult the bowtie 2 documentation found [at this link](http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml).

**sample\_info.tsv** - A simplified version of your provided csv. We store it so that you will be able to reference it in the future to see what comparisons your were making when you ran the expression tool.

**logs** - This directory contains logs for every job performed by OCT. It is partially populated by every tool.




